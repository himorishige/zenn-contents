---
title: "Next.js v11 ã§æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹ã¨ãã®å‚™å¿˜éŒ²"
emoji: "ğŸš´â€â™‚ï¸"
type: "tech"
topics: ["nextjs", "typescript"]
published: true
---

# ã¯ã˜ã‚ã«

æ˜æ—¥ã®è‡ªåˆ†ã®ãŸã‚ã«ã€Next.js v11ã§`create-next-app`ç›´å¾Œã«è¡Œã£ã¦ã„ã‚‹é–‹ç™ºå‰ã®ä¸‹æº–å‚™ã®å‚™å¿˜éŒ²ã«ãªã‚Šã¾ã™ã€‚
`create-next-app`ã§ã¯è‡ªåˆ†ã§ä½œã£ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’gitç’°å¢ƒã«ç½®ãã“ã¨ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```bash
$ yarn create next-app PROJECT_NAME -e gitrepositoryURL
```
https://nextjs.org/docs/api-reference/create-next-app

~~ãªãŠä»¥ä¸‹ã¯æ‰‹å‹•ã§TypeScriptã‚’å…¥ã‚Œã¦ã„ãã¾ã™ãŒã€Next.jså´ã§ã‚‚TypeScriptã®åˆæœŸè¨­å®šã‚’è¡Œã£ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚‚ç”¨æ„ã—ã¦ãã‚Œã¦ã„ã¾ã™ã®ã§ã€ã“ã¡ã‚‰ã®æ–¹ãŒæ—©ã„ã¨ã„ã†å™‚ã‚‚ã‚ã‚Šã¾ã™ã€‚ã€‚
ãŸã ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¯ä¸è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚‚å¤šã„ã®ã§ç§ã¯æ‰‹å‹•ã§å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚~~

:::message
å…¬å¼ã®create-next-appã§TypeScriptã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå®Ÿè£…ã•ã‚Œã¾ã—ãŸã€‚
ç¾åœ¨ã¯create-next-appã«--tsã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ã§strict: trueãªTypeScriptãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆå¯èƒ½ã§ã™ã€‚

ã¾ãŸã€Next.js v11.1.1ã‚ˆã‚Šã‚«ã‚¹ã‚¿ãƒ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’functional componentã¨ã—ã¦è¨˜è¼‰ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
:::

```bash
npx create-next-app --ts
# or
yarn create next-app --typescript
```
https://nextjs.org/docs/basic-features/typescript

## 1. Next.jsã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
ä½•ã¯ã¨ã‚‚ã‚ã‚Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã€‚

```bash
$ yarn create next-app PROJECT_NAME
or
$ npx create-next-app PROJECT_NAME
```

## 2. `pages`é…ä¸‹ã€`styles`é…ä¸‹ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’`/src`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã«ã¯å¥½ã¿ã‚‚ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€ç§ã¯`/src`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¾ã¨ã‚ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

:::message
ä¸€éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ ã‚„ãƒªãƒãƒ¼ãƒ ãªã©ã«ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚macosã‚„WSL2ã€linuxä»¥å¤–ã®ç’°å¢ƒã‚’ãŠä½¿ã„ã®æ–¹ã¯ç›´æ¥ãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ ç·¨é›†ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
:::

```bash
$ cd PROJECT_NAME
$ mkdir src && mv pages src/pages & mv styles src/styles
```

## 3. TypeScriptã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

TypeScriptã®æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```bash
$ yarn add -D typescript @types/react @types/react-dom @types/node
# or
$ npm i -D typescript @types/react @types/react-dom @types/node
```

## 4. `.js`æ‹¡å¼µå­ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’`.ts`ã€`.tsx`æ‹¡å¼µå­ã«å¤‰æ›´

`/src`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã«ã‚ã‚‹`.js`æ‹¡å¼µå­ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’`.ts`ã€`.tsx`æ‹¡å¼µå­ã«å¤‰æ›´ã—ã¾ã™ã€‚

```bash
$ find src/pages -name "_app.js" -or -name "index.js" | sed 'p;s/.js$/.tsx/' | xargs -n2 mv & \\
  find src/pages/api -name "*.js" | sed 'p;s/.js$/.ts/' | xargs -n2 mv
```

## 5. `tsconfig.json`ã¨`next-env.d.ts`ãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ 

ã“ã®æ™‚ç‚¹ã§é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã™ã‚‹ã¨Next.jsãŒè‡ªå‹•çš„ã«`tsconfig.json`ã¨`next-env.d.ts`ã‚’ä½œæˆã—ã¦ãã‚Œã¾ã™ã€‚

```bash
$ yarn dev
or
$ npm run dev
```

## 6. TypeScriptã®è¨­å®šã‚’å¤‰æ›´

`strict`ãƒ¢ãƒ¼ãƒ‰ã‚’`true`ã«å¤‰æ›´ã—ã¾ã™ã€‚

:::message
ç¾åœ¨ã¯`true`ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ãªã‚Šã¾ã—ãŸã€‚
:::

```json:tsconfig.json
"strict": false,
->
"strict": true,
```

ã¾ãŸã€ã“ã®éƒ¨åˆ†ã¯å¥½ã¿ã§ã™ãŒ`baseURL`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«`.`ã‚’è¿½åŠ ã—ã¾ã™ã€‚
`.`ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§TypeScriptãƒ•ã‚¡ã‚¤ãƒ«å†…ã§`import`ã™ã‚‹éš›ã«`src/hogehoge`ã¨ã„ã£ãŸå½¢ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã‹ã‚‰ã®ãƒ‘ã‚¹ã§è¨˜è¼‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```json:tsconfig.json
{
  "compilerOptions": {
    // add
    "baseUrl": "."
  }
}
```

## 7. `_app.tsx`ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£

TypeScriptã®å‹æƒ…å ±ã‚’ä»˜ä¸ã—ã¦ã„ãä½œæ¥­ã¨ã€é–¢æ•°ã‚’ã‚¢ãƒ­ãƒ¼é–¢æ•°ã«å¤‰æ›´ã—ã¾ã™ã€‚

```typescript:src/pages/_app.tsx
import { AppProps } from 'next/app';
import '../styles/globals.css';

const MyApp = ({ Component, pageProps }: AppProps): JSX.Element => {
  return <Component {...pageProps} />;
};

export default MyApp;
```

## 8. `index.tsx`ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£

åŒã˜ãã“ã¡ã‚‰ã‚‚ä¿®æ­£ã—ã¦ã„ãã¾ã™ã€‚

```typescript:src/pages/index.tsx
import Head from 'next/head';
import Image from 'next/image';
import { NextPage } from 'next';
import styles from '../styles/Home.module.css';

const Home: NextPage = () => {
//
// ã“ã®ä¸­èº«ã¯ãã®ã¾ã¾åˆ©ç”¨ã—ã¾ã™ã€‚
//
};

export default Home;
```

## 9. `api/hello.ts`ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£

åˆ©ç”¨ã—ãªã„ã“ã¨ã‚‚å¤šã„ã§ã™ãŒä¸€å¿œã“ã¡ã‚‰ã‚‚ä¿®æ­£ã—ã¦ãŠãã¾ã™ã€‚

```typescript:src/pages/api/hello.ts
import type { NextApiRequest, NextApiResponse } from 'next';

type Data = {
  name: string;
};

const hello = (req: NextApiRequest, res: NextApiResponse<Data>) => {
  res.status(200).json({ name: 'John Doe' });
};

export default hello;
```

## 10. ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è¿½åŠ 

metaã‚¿ã‚°é¡ã‚„Webãƒ•ã‚©ãƒ³ãƒˆã®åˆ©ç”¨ãªã©ã«å¿…è¦ã¨ãªã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```bash
$ touch src/pages/_document.tsx
```

:::message
Next.js v11.1.1ã‚ˆã‚Šã‚«ã‚¹ã‚¿ãƒ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’functional componentã¨ã—ã¦è¨˜è¼‰ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
:::

https://github.com/vercel/next.js/pull/28515

```typescript:src/pages/_document.tsx
import { Html, Head, Main, NextScript } from 'next/document';

const MyDocument = () => {
  const url = '<https://example.com>';
  const title = 'Demo Next.js';
  const description = 'Demo of Next.js';

  return (
    <Html lang="ja-JP">
      <Head>
        {/* Change the contents of `<Head>` as needed. */}
        <meta name="description" content={description} />
        <meta name="theme-color" content="#333" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content={title} />
        <meta property="og:url" content={url} />
        <meta property="og:description" content={description} />
        <meta property="og:site_name" content={title} />
        <meta property="og:image" content={`${url}/ogp.png`} />
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="format-detection" content="telephone=no" />
        <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
      </Head>
      <body>
        <Main />
        <NextScript />
      </body>
    </Html>
  );
};

export default MyDocument;
```

ä»¥ä¸‹å¾“æ¥ã®Class componentã§è¨˜è¼‰ã®å ´åˆ

```typescript:src/pages/_document.tsx
import React from 'react'
import Document, { Html, Head, Main, NextScript } from 'next/document'

interface MyDocumentInterface {
  url: string
  title: string
  description: string
}

class MyDocument extends Document implements MyDocumentInterface {
  url = '<https://example.com>'
  title = 'Demo Next.js'
  description = 'Demo of Next.js'

  render(): JSX.Element {
    return (
      <Html lang="ja-JP">
        <Head>
          {/* Change the contents of `<Head>` as needed. */}
          <meta name="description" content={this.description} />
          <meta name="theme-color" content="#333" />
          <meta property="og:type" content="website" />
          <meta property="og:title" content={this.title} />
          <meta property="og:url" content={this.url} />
          <meta property="og:description" content={this.description} />
          <meta property="og:site_name" content={this.title} />
          <meta property="og:image" content={`${this.url}/ogp.png`} />
          <meta name="twitter:card" content="summary_large_image" />
          <meta name="format-detection" content="telephone=no" />
          <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
        </Head>
        <body>
          <Main />
          <NextScript />
        </body>
      </Html>
    )
  }
}

export default MyDocument
```

## 11. Sassã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Sassã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã«é™ã‚Šã¾ã™ãŒã€å¿…è¦ã«å¿œã˜ã¦Sassã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```bash
$ yarn add -D sass
```

## 12. èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®èª¿æ•´

åŒã˜ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®ä»–ã®PCã‚„ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã‹ã‚‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã¦é–²è¦§ç¢ºèªãŒã§ãã‚‹ã‚ˆã†ã€é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’èª¿æ•´ã—ã¾ã™ã€‚

```json:packages.json
{
  ...
  "scripts": {
    "dev": "next dev --hostname 0.0.0.0",
  },
  ...
}
```

## 13. Prettierã®è¨­å®š

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚ˆã‚Šã¾ã™ãŒã€Prettierã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚

```bash
$ touch .prettierrc
```

```javascript:.prettierrc
{
  "trailingComma": "all",
  "semi": true,
  "singleQuote": true,
  "printWidth": 100,
  "tabWidth": 2
}
```

## 14. ESLint

Next.js v11ã‹ã‚‰ESLintã¯Next.jsã§è¿½åŠ ã•ã‚ŒãŸã‚‚ã®ã‚’ä½¿ã†ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚
ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚ˆã£ã¦éšæ™‚å¯¾å¿œã€‚ã€‚ã€‚

## 15. ãã®ä»–

Storybookã€Jestã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚ˆã£ã¦éšæ™‚è¿½åŠ ã€‚ã€‚ã€‚