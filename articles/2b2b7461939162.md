---
title: "Expressã¨mongoDBã‚’ä½¿ã£ãŸREST APIã‚’TypeScriptã§çµ„ã‚“ã§ã¿ã‚‹ã€1.ç’°å¢ƒæ§‹ç¯‰ç·¨ã€‘"
emoji: "ğŸ¥­"
type: "tech"
topics: ["mongodb", "typescript", "express"]
published: true
---

# ã¯ã˜ã‚ã«

Expressï¼ˆTypeScriptï¼‰ã‚’åˆ©ç”¨ã—ã¦mongoDBï¼ˆmongoDB Atlasï¼‰ã¨ã®é€£æºã‚’ã™ã‚‹æ–¹æ³•ã®å‚™å¿˜éŒ²ã«ãªã‚Šã¾ã™ã€‚
â€»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚„ã‚¨ãƒ©ãƒ¼å‡¦ç†ã«ã¤ã„ã¦ã¯è€ƒæ…®ã•ã‚Œã¦ã„ãªã„ç‚¹ã”äº†æ‰¿ãã ã•ã„ã€‚

ä»Šå›ã¯ç’°å¢ƒæ§‹ç¯‰ã¨ã„ã†ã“ã¨ã§mongoDB Atlasã®è¨­å®šã¨ã€ç’°å¢ƒè¨­å®šã¾ã§ã€‚

# mongoDB Atlasã®è¨­å®š

ä»Šå›ã¯1ã¤ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§1ã¤é™å®šã«ãªã‚Šã¾ã™ãŒã€512MBã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¾ã§ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç„¡æ–™ã§åˆ©ç”¨ã§ãã‚‹mongo DB Atlasã‚’åˆ©ç”¨ã—ã¾ã—ãŸã€‚
googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒã£ã¦ã„ã‚‹ã¨ç°¡å˜ã«ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ã§ãã¾ã™ã€‚

https://www.mongodb.com

ã“ã®ã‚ã¨ç”»åƒãŒãŸãã•ã‚“ç¶šãã¾ã™ã€‚ã€‚ã€‚

![](https://storage.googleapis.com/zenn-user-upload/e53906b0a7dfeda9f61b5708.png)
![](https://storage.googleapis.com/zenn-user-upload/d3483e2ef48b449632154c2b.png)
![](https://storage.googleapis.com/zenn-user-upload/cad647edcc639487c41bb49b.png)
![](https://storage.googleapis.com/zenn-user-upload/b1ced2645afc53033550bef9.png)
![](https://storage.googleapis.com/zenn-user-upload/982948981d9308cc17c84b06.png)
![](https://storage.googleapis.com/zenn-user-upload/3675fd1df454ab9bc287fc12.png)
![](https://storage.googleapis.com/zenn-user-upload/246ea99c116d4eaf8230b438.png)
![](https://storage.googleapis.com/zenn-user-upload/675e5624543dae83b6c1909c.png)
![](https://storage.googleapis.com/zenn-user-upload/2fa46dcc8bf9d9ab416f9a32.png)
![](https://storage.googleapis.com/zenn-user-upload/82e0f7c701123dd10fc2508f.png)
![](https://storage.googleapis.com/zenn-user-upload/00d31ae693a941a00bdaf4da.png)
![](https://storage.googleapis.com/zenn-user-upload/48afcb786bd3393dcd862f3d.png)
![](https://storage.googleapis.com/zenn-user-upload/edb5816066721259f15f78b8.png)
![](https://storage.googleapis.com/zenn-user-upload/897308248f4305ef43c3cccf.png)
![](https://storage.googleapis.com/zenn-user-upload/c9709422c2bf66ebd06a9b4f.png)

ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼
ã“ã‚Œã§mongoDBã®æº–å‚™ãŒå®Œäº†ã§ã™ã€‚

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

ã¾ãšã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æ–°è¦ä½œæˆã—ã¾ã™ã€‚
ä»Šå›ã¯`tech-blog-backend`ã¨ã„ã†åç§°ã§ä½œæˆã—ã¾ã—ãŸã€‚

```bash
$ mkdir tech-blog-backend
$ cd tech-blog-backend
$ npm init -y
```

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```
$ yarn add express cors dotenv express-async-handler mongoose
$ yarn add -D @types/node @types/express @types/mongoose @types/cors rimraf @types/rimraf ts-node ts-node-dev npm-run-all typescript
```

rimrafã€ts-nodeã€ts-node-devã€npm-run-allã«ã¤ã„ã¦ã¯TypeScriptã®å¤‰æ›ã¨ãƒ­ãƒ¼ã‚«ãƒ«ã§èµ·å‹•ã•ã›ã‚‹ãŸã‚ã«ãã‚Œãã‚Œåˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚

ä»Šå›mongoDBã¨ã®ã‚„ã‚Šå–ã‚Šã«ã¯mongoDBå‘ã‘ã®ORMã§ã‚ã‚‹mongooseã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

https://mongoosejs.com/

# ç’°å¢ƒè¨­å®š

ã¾ãŸã€package.jsonãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½è¨˜ã—ãŸéƒ¨åˆ†ã¯ä¸‹è¨˜ã«ãªã‚Šã¾ã™ã€‚

```typescript:src/package.json
{
  ...
  "main": "dist/index.js",
  "scripts": {
    "dev": "ts-node-dev --respawn src/index.ts", // é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
    "clean": "rimraf dist", // ãƒ“ãƒ«ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤
    "tsc": "tsc",  // TypeScriptã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
    "build": "npm-run-all clean tsc",  // ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
    "start": "node .", // ãƒ“ãƒ«ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
    "data:import": "node dist/seed", // mongoDBã¸ã®ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
    "data:destroy": "node dist/seed -d" // ãƒ‡ãƒ¼ã‚¿ã®ã‚¯ãƒªã‚¢
  },
  ...
}
```

ä»Šå›tsconfig.jsonã¯ä¸‹è¨˜è¨­å®šã§æ–°è¦ä½œæˆã—ã¾ã—ãŸã€‚

```typescript:tsconfig.json
{
  "compilerOptions": {
    "target": "es5" /* Specify ECMAScript target version: 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017', 'ES2018', 'ES2019', 'ES2020', or 'ESNEXT'. */,
    "module": "commonjs" /* Specify module code generation: 'none', 'commonjs', 'amd', 'system', 'umd', 'es2015', 'es2020', or 'ESNext'. */,
    "sourceMap": true /* Generates corresponding '.map' file. */,
    "outDir": "./dist" /* Redirect output structure to the directory. */,
    "strict": true /* Enable all strict type-checking options. */,
    "moduleResolution": "node" /* Specify module resolution strategy: 'node' (Node.js) or 'classic' (TypeScript pre-1.6). */,
    "esModuleInterop": true /* Enables emit interoperability between CommonJS and ES Modules via creation of namespace objects for all imports. Implies 'allowSyntheticDefaultImports'. */,
    "skipLibCheck": true /* Skip type checking of declaration files. */,
    "forceConsistentCasingInFileNames": true /* Disallow inconsistently-cased references to the same file. */
  },
  "include": ["src/**/*"]
}
```

ã¾ãŸã€mongoDB Atlasã¨ã®æ¥ç¶šæƒ…å ±ã¯`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰ã—ã¾ã™ã€‚
ç®¡ç†ç”»é¢ã‹ã‚‰å–å¾—ã—ãŸæƒ…å ±ã«ã€ã”è‡ªèº«ã§è¨­å®šã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åã‚’è¿½è¨˜å¤‰æ›´ã—ã¦è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚

```javascript:.env
MONGO_URI=mongodb+srv://è¨­å®šã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼å:è¨­å®šã—ãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰@cluster0.dcip*.mongodb.net/è¨­å®šã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å?retryWrites=true&w=majority
```

`.env`ãƒ•ã‚¡ã‚¤ãƒ«ãªã©ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’gitç’°å¢ƒã«ã‚ã’ãªã„ã‚ˆã†ã«å¿˜ã‚Œãšã«`.gitignore`ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ç”¨æ„ã—ã¦ãŠãã¾ã™ã€‚

```javascript:.gitignore
# dependencies
/node_modules
/.pnp
.pnp.js

# testing
/coverage

# production
/dist

# misc
.DS_Store
.env
.env.local
.env.development.local
.env.test.local
.env.production.local

npm-debug.log*
yarn-debug.log*
yarn-error.log*
```

# ã•ã„ã”ã«

ã“ã‚Œã§ç’°å¢ƒæ§‹ç¯‰å®Œäº†ã§ã™ï¼
æ¬¡å›ã¯DBã¸ã®æ¥ç¶šãƒ†ã‚¹ãƒˆã¨ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥ã—ã¦ã¿ã¾ã™ã€‚

ãªãŠã€å®Œæˆç‰ˆï¼Ÿã®ã‚½ãƒ¼ã‚¹ã¯ã“ã¡ã‚‰ã«ãªã‚Šã¾ã™ã€‚

https://github.com/himorishige/techBlog-backend

https://zenn.dev/himorishige/articles/5b645e7eb45f3e

https://zenn.dev/himorishige/articles/5084aab24c9f35